
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>HTTP Collect</title>
    <meta name="description" content="">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" type="text/css" href="../assets/css/application.css?v=afb6a2fa27">
    <link href="https://fonts.googleapis.com/css?family=Lato:300,400,300italic,400italic" rel="stylesheet" type="text/css">
    <link rel="canonical" href="index.html">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <link rel="amphtml" href="amp/index.html">
    
    <meta property="og:site_name" content="Manoj Kumar">
    <meta property="og:type" content="article">
    <meta property="og:title" content="HTTP Collect">
    <meta property="og:description" content='Problem Write a program that performs an HTTP GET request to a URL provided to you as the first command-line argument. Collect all data from the server (not just the first "data" event) and then write two lines to the console (stdout).   The first line you write should just be'>
    <meta property="og:url" content="https://ghost-nithmanoj.c9users.io/http-collect/">
    <meta property="article:published_time" content="2016-11-14T06:51:56.000Z">
    <meta property="article:modified_time" content="2016-11-14T10:03:22.000Z">
    <meta property="article:tag" content="nodejs">
    
    <meta property="article:publisher" content="https://www.facebook.com/owsmmj">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="HTTP Collect">
    <meta name="twitter:description" content='Problem Write a program that performs an HTTP GET request to a URL provided to you as the first command-line argument. Collect all data from the server (not just the first "data" event) and then write two lines to the console (stdout).   The first line you write should just be'>
    <meta name="twitter:url" content="https://ghost-nithmanoj.c9users.io/http-collect/">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Manoj Kumar">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="nodejs">
    <meta name="twitter:site" content="@owsmmj">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Manoj Kumar",
        "logo": "https://ghost-nithmanoj.c9users.io/content/images/2016/10/nmjbot-min-1.jpg"
    },
    "author": {
        "@type": "Person",
        "name": "Manoj Kumar",
        "image": {
            "@type": "ImageObject",
            "url": "//www.gravatar.com/avatar/4488b14e87a39b3e2f09d00070d68f96?s=250&d=mm&r=x",
            "width": 250,
            "height": 250
        },
        "url": "https://ghost-nithmanoj.c9users.io/author/manoj/",
        "sameAs": []
    },
    "headline": "HTTP Collect",
    "url": "https://ghost-nithmanoj.c9users.io/http-collect/",
    "datePublished": "2016-11-14T06:51:56.000Z",
    "dateModified": "2016-11-14T10:03:22.000Z",
    "keywords": "nodejs",
    "description": "Problem Write a program that performs an HTTP GET request to a URL provided to you as the first command-line argument. Collect all data from the server (not just the first &quot;data&quot; event) and then write two lines to the console (stdout).   The first line you write should just be",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://ghost-nithmanoj.c9users.io"
    }
}
    </script>

    <meta name="generator" content="Ghost 0.11">
    <link rel="alternate" type="application/rss+xml" title="Manoj Kumar" href="../rss/index.html">
  </head>
  <body>
    <div class="container">
      <header class="center">
        <div class="blog-title"><a href="../">Manoj Kumar</a></div>
        <div class="blog-description">Fun and Profit NodeJs Python</div>
        <nav>
    <a class="nav-list " href="../">Home</a>
</nav>

      </header>
      


<div class="post-title">
  <h1><a href="index.html">HTTP Collect</a></h1>
</div>
<article class="row" role="main">
  <h3 id="problem">Problem</h3>

<p>Write a program that performs an HTTP GET request to a URL provided to you as the first command-line argument. Collect all data from the server (not just the first "data" event) and then write two lines to the console (stdout).  </p>

<p>The first line you write should just be an integer representing the number of characters received from the server. The second line should contain the complete String of characters sent by the server. </p>

<h3 id="approaches">Approaches</h3>

<p>There are two approaches you can take to this problem:  </p>

<h5 id="1bylogicapproach">1. By logic Approach</h5>

<p>Collect data across multiple "data" events and append the results together prior to printing the output. Use the "end" event to determine when the stream is finished and you can write the output. </p>

<pre><code class="language-javascript">var http = require('http');

var url = process.argv[2];

http.get(url, function(response){

    var fullData = '';
    response.setEncoding('utf8');
    response.on('data', function(data){
        fullData += data;
    });
    response.on('end', function(){
        console.log(fullData.length);
        console.log(fullData);
    });
    response.on('error', console.error);
}).on('error', console.error);
</code></pre>

<h5 id="2thirdpartypackageapproach">2. Third Party Package Approach</h5>

<p>2) Use a third-party package to abstract the difficulties involved in collecting an entire stream of data. Two different packages provide a useful API for solving this problem (there are likely more!): <code>bl</code> (Buffer List) and <code>concat-stream</code> take your pick!  </p>

<blockquote>
<pre><code>$ npm install bl  
</code></pre>
</blockquote>

<p>Both <code>bl</code> and <code>concat-stream</code> can have a stream piped in to them and they will collect the data for you. Once the stream has ended, a callback will be fired with the data:  </p>

<pre><code class="language-javascript   ">   response.pipe(bl(function (err, data) {
     /* ... */ 
   }))

     // or  

   response.pipe(concatStream(function (data) {
        /* ... */ 
   }))  
</code></pre>

<p>Note that you will probably need to <code>data.toString()</code> to convert from a Buffer.  </p>

<p><strong><em>solution</em></strong></p>

<pre><code class="language-javascript">    var http = require('http')
    var bl = require('bl')

    http.get(process.argv[2], function (response) {
      response.pipe(bl(function (err, data) {
        if (err) {
          return console.error(err)
        }
        data = data.toString()
        console.log(data.length)
        console.log(data)
      }))
    })
</code></pre>
</article>
<hr>
<div class="row center">
  <div class="col-12">
    <h4>
      <span class="small"><a href="../author/manoj/">Manoj Kumar</a> at</span>
      <time class="small" datetime="2016-11-14">2016 Nov 14</time>
      <span class="small"> | <a href="../tag/nodejs/">nodejs</a></span>
    </h4>
  </div>
  <div class="col-12">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
    if(disqus_shortname && typeof disqus_shortname === "string") {
      var disqus_identifier = '';
      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    }
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
  <div class="col-12">
    <h4>Share this post on</h4>
    <a href="https://www.facebook.com/sharer/sharer.php?u=https://ghost-nithmanoj.c9users.io/http-collect/" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
      Facebook
    </a>
    <a href="https://twitter.com/intent/tweet?text=HTTP%20Collect&amp;url=https://ghost-nithmanoj.c9users.io/http-collect/" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
      Twitter
    </a>
  </div>
</div>
<div class="row center">
  <div class="col-6">
  </div>
  <div class="col-6">
    <a href="../welcome-to-ghost/">
      <h5>Welcome to Ghost  ❯</h5>
    </a>
  </div>
</div>

      <footer class="center">
        <p class="small"><a href="../">Manoj Kumar</a> © 2016</p>
        <p class="small">Powered by <a href="https://ghost.org" target="_blank">Ghost</a> | Theme - <a href="https://github.com/imgarylai/text" target="_blank">text</a></p>
      </footer>
    </div>
    <script type="text/javascript" src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/highlight.min.js"></script>
    <script type="text/javascript" src="../assets/js/highlightjs-line-numbers.min.js?v=afb6a2fa27"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/styles/github.min.css">
    <script>
      hljs.initHighlightingOnLoad();
    </script>
    <script>
      if (window.ga_id) {
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', window.ga_id, 'auto');
        ga('require', 'linkid', 'linkid.js');
        ga('send', 'pageview');
      }
    </script>
    
  </body>
