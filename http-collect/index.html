
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>HTTP Collect</title>
    <meta name="description" content="">

    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="shortcut icon" href="../assets/favicon2.ico?v=af63723a3f">

    <link rel="stylesheet" type="text/css" href="../assets/css/screen.css?v=af63723a3f">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic%7COpen+Sans:700,400">
    <link rel="stylesheet" type="text/css" href="../assets/css/prism.css?v=af63723a3f"> 

    <link rel="canonical" href="index.html">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <link rel="amphtml" href="amp/index.html">
    
    <meta property="og:site_name" content="Manoj Kumar">
    <meta property="og:type" content="article">
    <meta property="og:title" content="HTTP Collect">
    <meta property="og:description" content='Problem Write a program that performs an HTTP GET request to a URL provided to you as the first command-line argument. Collect all data from the server (not just the first "data" event) and then write two lines to the console (stdout).   The first line you write should just be'>
    <meta property="og:url" content="https://ghost-nithmanoj.c9users.io/http-collect/">
    <meta property="article:published_time" content="2016-11-14T06:51:56.000Z">
    <meta property="article:modified_time" content="2016-11-16T16:07:15.000Z">
    <meta property="article:tag" content="nodejs">
    
    <meta property="article:publisher" content="https://www.facebook.com/owsmmj">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="HTTP Collect">
    <meta name="twitter:description" content='Problem Write a program that performs an HTTP GET request to a URL provided to you as the first command-line argument. Collect all data from the server (not just the first "data" event) and then write two lines to the console (stdout).   The first line you write should just be'>
    <meta name="twitter:url" content="https://ghost-nithmanoj.c9users.io/http-collect/">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Manoj Kumar">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="nodejs">
    <meta name="twitter:site" content="@owsmmj">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Manoj Kumar",
        "logo": "https://ghost-nithmanoj.c9users.io/content/images/2016/10/nmjbot-min-1.jpg"
    },
    "author": {
        "@type": "Person",
        "name": "Manoj Kumar",
        "image": {
            "@type": "ImageObject",
            "url": "//www.gravatar.com/avatar/4488b14e87a39b3e2f09d00070d68f96?s=250&d=mm&r=x",
            "width": 250,
            "height": 250
        },
        "url": "https://ghost-nithmanoj.c9users.io/author/manoj/",
        "sameAs": []
    },
    "headline": "HTTP Collect",
    "url": "https://ghost-nithmanoj.c9users.io/http-collect/",
    "datePublished": "2016-11-14T06:51:56.000Z",
    "dateModified": "2016-11-16T16:07:15.000Z",
    "keywords": "nodejs",
    "description": "Problem Write a program that performs an HTTP GET request to a URL provided to you as the first command-line argument. Collect all data from the server (not just the first &quot;data&quot; event) and then write two lines to the console (stdout).   The first line you write should just be",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://ghost-nithmanoj.c9users.io"
    }
}
    </script>

    <meta name="generator" content="Ghost 0.11">
    <link rel="alternate" type="application/rss+xml" title="Manoj Kumar" href="../rss/index.html">
</head>
<body class="post-template tag-nodejs nav-closed">

    <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="index.html#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
            <li class="nav-home" role="presentation"><a href="../">Home</a></li>
            <li class="nav-nodejs" role="presentation"><a href="../tag/nodejs/">NodeJS</a></li>
    </ul>
        <a class="subscribe-button icon-feed" href="../rss/index.rss">Subscribe</a>
</div>
<span class="nav-cover"></span>


    <div class="site-wrapper">

        


<header class="main-header post-head no-cover">
    <nav class="main-nav  clearfix">
        <a class="blog-logo" href="../"><img src="../content/images/2016/10/nmjbot-min-1.jpg" alt="Manoj Kumar"></a>
            <a class="menu-button icon-menu" href="index.html#"><span class="word">Menu</span></a>
    </nav>
</header>

<main class="content" role="main">
    <article class="post tag-nodejs">

        <header class="post-header">
            <h1 class="post-title">HTTP Collect</h1>
            <section class="post-meta">
                <time class="post-date" datetime="2016-11-14">14 November 2016</time>  on <a href="../tag/nodejs/">nodejs</a>
            </section>
        </header>

        <section class="post-content">
            <h3 id="problem">Problem</h3>

<p>Write a program that performs an HTTP GET request to a URL provided to you as the first command-line argument. Collect all data from the server (not just the first "data" event) and then write two lines to the console (stdout).  </p>

<p>The first line you write should just be an integer representing the number of characters received from the server. The second line should contain the complete String of characters sent by the server. </p>

<h3 id="approaches">Approaches</h3>

<p>There are two approaches you can take to this problem:  </p>

<h5 id="1bylogicapproach">1. By logic Approach</h5>

<p>Collect data across multiple "data" events and append the results together prior to printing the output. Use the "end" event to determine when the stream is finished and you can write the output. </p>

<pre><code class="language-javascript">var http = require('http');

var url = process.argv[2];

http.get(url, function(response){

    var fullData = '';
    response.setEncoding('utf8');
    response.on('data', function(data){
        fullData += data;
    });
    response.on('end', function(){
        console.log(fullData.length);
        console.log(fullData);
    });
    response.on('error', console.error);
}).on('error', console.error);
</code></pre>

<p><br>  </p>

<h5 id="2thirdpartypackageapproach">2. Third Party Package Approach</h5>

<p>2) Use a third-party package to abstract the difficulties involved in collecting an entire stream of data. Two different packages provide a useful API for solving this problem (there are likely more!): <code>bl</code> (Buffer List) and <code>concat-stream</code> take your pick!  </p>

<blockquote>
<pre><code>$ npm install bl  
</code></pre>
</blockquote>

<p>Both <code>bl</code> and <code>concat-stream</code> can have a stream piped in to them and they will collect the data for you. Once the stream has ended, a callback will be fired with the data:  </p>

<pre><code class="language-javascript   ">   response.pipe(bl(function (err, data) {
     /* ... */ 
   }))

     // or  

   response.pipe(concatStream(function (data) {
        /* ... */ 
   }))  
</code></pre>

<p>Note that you will probably need to <code>data.toString()</code> to convert from a Buffer.  </p>

<p><strong><em>solution</em></strong></p>

<pre><code class="language-javascript">    var http = require('http')
    var bl = require('bl')

    http.get(process.argv[2], function (response) {
      response.pipe(bl(function (err, data) {
        if (err) {
          return console.error(err)
        }
        data = data.toString()
        console.log(data.length)
        console.log(data)
      }))
    })
</code></pre>

<p><em>What do you think about post? Share your thoughts in the comments below!</em></p>

<hr>
        </section>

        <footer class="post-footer">


            <figure class="author-image">
                <a class="img" href="../author/manoj/" style="background-image: url(https://www.gravatar.com/avatar/4488b14e87a39b3e2f09d00070d68f96?s&amp;)"><span class="hidden">Manoj Kumar's Picture</span></a>
            </figure>

            <section class="author">
                <h4><a href="../author/manoj/">Manoj Kumar</a></h4>

                    <p>Read <a href="../author/manoj/">more posts</a> by this author.</p>
                <div class="author-meta">
                    
                    
                </div>
            </section>


            <section class="share">
                <h4>Share this post</h4>
                <a class="icon-twitter" href="https://twitter.com/intent/tweet?text=HTTP%20Collect&amp;url=https://ghost-nithmanoj.c9users.io/http-collect/" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <span class="hidden">Twitter</span>
                </a>
                <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://ghost-nithmanoj.c9users.io/http-collect/" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <span class="hidden">Facebook</span>
                </a>
                <a class="icon-google-plus" href="https://plus.google.com/share?url=https://ghost-nithmanoj.c9users.io/http-collect/" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <span class="hidden">Google+</span>
                </a>
            </section>

            <div id="disqus_thread"></div>
<script>

/**
 *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
 *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables */
/*
var disqus_config = function () {
    this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
    this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = '//kumarmj-me.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                                    

        </footer>

    </article>
</main>





        <footer class="site-footer clearfix">
            <section class="copyright"><a href="../">Manoj Kumar</a> © 2017</section>
            <section class="poweredby">Proudly published with <a href="https://ghost.org">Ghost</a></section>
        </footer>

    </div>

    <script type="text/javascript" src="https://code.jquery.com/jquery-1.12.0.min.js"></script>
    
    <script type="text/javascript" src="../assets/js/jquery.fitvids.js?v=af63723a3f"></script>
    <script type="text/javascript" src="../assets/js/index.js?v=af63723a3f"></script>
    <script type="text/javascript" src="../assets/js/prism.js?v=af63723a3f"></script>
</body>
